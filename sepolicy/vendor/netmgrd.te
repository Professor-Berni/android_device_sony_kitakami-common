type netmgrd, domain;
type netmgrd_exec, exec_type, file_type;

# Started by init
init_daemon_domain(netmgrd)

allow netmgrd default_prop:file r_file_perms;
allow netmgrd device:chr_file rw_file_perms;
allow netmgrd dnsresolver_service:service_manager find;
allow netmgrd hwservicemanager:binder call;
allow netmgrd hwservicemanager_prop:file r_file_perms;
allow netmgrd net_data_file:dir read;
allow netmgrd netd:binder call;
allow netmgrd netd_service:service_manager find;
allow netmgrd proc_net:file rw_file_perms;
allow netmgrd qmuxd:unix_stream_socket connectto;
allow netmgrd self:capability { net_admin net_raw setgid setpcap setuid sys_module };
allow netmgrd self:netlink_route_socket { create_socket_perms nlmsg_read };
allow netmgrd self:netlink_socket create_socket_perms;
allow netmgrd self:netlink_xfrm_socket create_socket_perms;
allow netmgrd self:rawip_socket create_socket_perms;
allow netmgrd self:socket create_socket_perms;
allow netmgrd self:tcp_socket create_socket_perms;
allow netmgrd self:udp_socket create_socket_perms;
allow netmgrd servicemanager:binder call;
allow netmgrd socket_device:dir w_dir_perms;
allow netmgrd socket_device:sock_file create_file_perms;
allow netmgrd sysfs:dir r_dir_perms;
allow netmgrd sysfs:file r_file_perms;
allow netmgrd system_file:file rx_file_perms;
allow netmgrd system_suspend_hwservice:hwservice_manager find;
allow netmgrd toolbox_exec:file rx_file_perms;
